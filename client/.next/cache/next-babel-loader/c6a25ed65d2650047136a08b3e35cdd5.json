{"ast":null,"code":"import { GoogleSpreadsheet } from 'google-spreadsheet';\nimport { moment } from 'moment';\nimport credentials from '../../google-poc/credencials.json';\nconst doc = new GoogleSpreadsheet('1a0xQ5yA92FcPePWJCQJmA_qMsMDe8mGTPs11IsuOVeA');\nexport default (async (req, res) => {\n  try {\n    await doc.useServiceAccountAuth(credentials);\n    await doc.loadInfo();\n    console.log(doc.title);\n    const sheet = doc.sheetsByIndex[1];\n    const data = JSON.parse(req.body);\n    const sheetConfig = doc.sheetsByIndex[1];\n    await sheetConfig.loadCells('A2:B2');\n    const promo = sheetConfig.getCell(1, 0);\n    let Cupom = '';\n    let Promo = '';\n    await sheet.addRow({\n      Nome: data.Nome,\n      Email: data.Email,\n      Whatsapp: data.Whatsapp,\n      Cupom: '03 7777',\n      Promo: 'CursoGratis',\n      DataHora: moment().format('MMMM Do YYYY, h:mm:ss')\n    });\n    res.end(req.body);\n  } catch (error) {\n    console.log(error);\n  }\n});","map":{"version":3,"sources":["C:/Users/marcato/Google Drive/Estudos/Fullstack-TulioFaria/client/pages/api/save.js"],"names":["GoogleSpreadsheet","moment","credentials","doc","req","res","useServiceAccountAuth","loadInfo","console","log","title","sheet","sheetsByIndex","data","JSON","parse","body","sheetConfig","loadCells","promo","getCell","Cupom","Promo","addRow","Nome","Email","Whatsapp","DataHora","format","end","error"],"mappings":"AAAA,SAASA,iBAAT,QAAkC,oBAAlC;AACA,SAASC,MAAT,QAAsB,QAAtB;AACA,OAAOC,WAAP,MAAwB,mCAAxB;AAEA,MAAMC,GAAG,GAAG,IAAIH,iBAAJ,CAAsB,8CAAtB,CAAZ;AAIA,gBAAe,OAAOI,GAAP,EAAYC,GAAZ,KAAoB;AAC/B,MAAI;AAGA,UAAMF,GAAG,CAACG,qBAAJ,CAA0BJ,WAA1B,CAAN;AACA,UAAMC,GAAG,CAACI,QAAJ,EAAN;AACAC,IAAAA,OAAO,CAACC,GAAR,CAAYN,GAAG,CAACO,KAAhB;AAEA,UAAMC,KAAK,GAAGR,GAAG,CAACS,aAAJ,CAAkB,CAAlB,CAAd;AACA,UAAMC,IAAI,GAAGC,IAAI,CAACC,KAAL,CAAWX,GAAG,CAACY,IAAf,CAAb;AAEA,UAAMC,WAAW,GAAGd,GAAG,CAACS,aAAJ,CAAkB,CAAlB,CAApB;AACA,UAAMK,WAAW,CAACC,SAAZ,CAAsB,OAAtB,CAAN;AACA,UAAMC,KAAK,GAAGF,WAAW,CAACG,OAAZ,CAAoB,CAApB,EAAuB,CAAvB,CAAd;AAEA,QAAIC,KAAK,GAAG,EAAZ;AACA,QAAIC,KAAK,GAAG,EAAZ;AAEA,UAAMX,KAAK,CAACY,MAAN,CAAa;AACfC,MAAAA,IAAI,EAAEX,IAAI,CAACW,IADI;AAEfC,MAAAA,KAAK,EAAEZ,IAAI,CAACY,KAFG;AAGfC,MAAAA,QAAQ,EAAEb,IAAI,CAACa,QAHA;AAIfL,MAAAA,KAAK,EAAE,SAJQ;AAKfC,MAAAA,KAAK,EAAE,aALQ;AAMfK,MAAAA,QAAQ,EAAG1B,MAAM,GAAG2B,MAAT,CAAgB,uBAAhB;AANI,KAAb,CAAN;AAUAvB,IAAAA,GAAG,CAACwB,GAAJ,CAAQzB,GAAG,CAACY,IAAZ;AACH,GA5BD,CA4BE,OAAOc,KAAP,EAAc;AACZtB,IAAAA,OAAO,CAACC,GAAR,CAAYqB,KAAZ;AACH;AACJ,CAhCD","sourcesContent":["import { GoogleSpreadsheet } from 'google-spreadsheet'\r\nimport { moment} from 'moment'\r\nimport credentials from '../../google-poc/credencials.json'\r\n\r\nconst doc = new GoogleSpreadsheet('1a0xQ5yA92FcPePWJCQJmA_qMsMDe8mGTPs11IsuOVeA')\r\n\r\n\r\n\r\nexport default async (req, res) => {\r\n    try {\r\n\r\n\r\n        await doc.useServiceAccountAuth(credentials)\r\n        await doc.loadInfo();\r\n        console.log(doc.title);\r\n\r\n        const sheet = doc.sheetsByIndex[1]\r\n        const data = JSON.parse(req.body)\r\n\r\n        const sheetConfig = doc.sheetsByIndex[1]\r\n        await sheetConfig.loadCells('A2:B2')\r\n        const promo = sheetConfig.getCell(1, 0);\r\n \r\n        let Cupom = ''\r\n        let Promo = ''\r\n\r\n        await sheet.addRow({\r\n            Nome: data.Nome,\r\n            Email: data.Email,\r\n            Whatsapp: data.Whatsapp,\r\n            Cupom: '03 7777',\r\n            Promo: 'CursoGratis',\r\n            DataHora : moment().format('MMMM Do YYYY, h:mm:ss')\r\n        })\r\n\r\n\r\n        res.end(req.body)\r\n    } catch (error) {\r\n        console.log(error)\r\n    }\r\n}"]},"metadata":{},"sourceType":"module"}